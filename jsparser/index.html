<!DOCTYPE html>
 
<html>
    <head>
        <title>Parse JS</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            body{margin: 0px 0px 0px 0px;font-size:18px}
            input{width:80px;}
            table{margin:0px 0px 0px 0px;}
            span.t{font-size:38px;color:white}
            textarea{background-color: lightyellow}
        </style>
         <link rel="stylesheet" type="text/css" href="../pages.css"  />
        <script src="../showcase/cookie.js"></script>
    <script src="../showcase/en.js"></script>
    <script src="JSParser.js"></script>
    </head>
    <body>
<table cellpadding="2" cellspacing="0" align="center"><tr height="70"><td style="padding-bottom:10px" colspan="3" align="center" valign=middle bgcolor="blue" id="h">
             <script>document.write(homestr)</script>Javascript Parser<a href="../"><img style="float:right;height:90px;margin-bottom:-40px;margin-top:-4px"  src="../frames.png" >       
        </td></tr>
        <tr  valign="bottom"><td>   
Copy-paste your Javascript codes here: <br>           
<textarea rows=40 cols=70 id="t"  onchange="javascript:reset()">
if (document.location.toString().indexOf("localhost") >= 0
        && typeof (handleErr) == 'undefined')
{
    function handleErr(msg, url, l)
    {
        var txt = "There was an error on this page.\n\n"
                + "Error: " + msg + "\n"
                + "URL:   " + url + "\n"
                + "Line:  " + l;
        return true;
    }
    window.onerror = handleErr;
}
if (typeof (expiretime) == 'undefined')
{
    var expiretime = (new Date()).getTime() + 3600000;
    var activeidletime = 3600000;
}
function findPositionnoScrolling(oElement, win)
{
    if (win == null)
        win = self;
    if (oElement == null)
        return [0, 0];
    if (typeof (oElement.offsetParent) != 'undefined')
    {
        var ii = 0;
        var originalElement = oElement;
        for (var posY = 0, posX = 0; ii++<10 && oElement!=null; oElement = oElement.offsetParent )
        {
            posY += oElement.offsetTop;
            posX += oElement.offsetLeft;
            if (oElement != originalElement && oElement != win.document.body && oElement != win.document.documentElement)
            {
                posY -= oElement.scrollTop;
                posX -= oElement.scrollLeft;
            }
        }
        return  [posX, posY];
    }
    else
    {
        return  [oElement.x, oElement.y];
    }
}
</textarea> </td><td valign="top" align="center"><br> 
<input style="vertical-align: top" type="button" value="Next Token" onclick="nextt()"><br>
<input style="vertical-align: top" type="button" value="All Tokens" onclick="tokens(this)"><br>
<span id="tc"></span><br>
<br>

<input style="vertical-align: top" type="button" value="Next Var" onclick="next('var',1)"><br>
<input style="vertical-align: top" type="button" value="All Vars" onclick="next('var')"><br>
<span id="vc"></span><br>
<br>

<input style="vertical-align: top" type="button" value="Next Func" onclick="next('function',1)"><br>
<input style="vertical-align: top" type="button" value="All Funcs" onclick="next('function')"><br>
<span id="fc"></span><br>
<br>

<input style="vertical-align: top" type="button" value="Next Stat" onclick="next('statement',1)"><br>
<input style="vertical-align: top" type="button" value="All Stats" onclick="next('statement')"><br>
<span id="sc"></span><br>
<br>

<input style="vertical-align: top" type="button" value="Next Any" onclick="next('any',1)"><br>
<input style="vertical-align: top" type="button" value="Validate" onclick="next('any')"><br>
<span id="ac"></span><br>
<br>

<input id=reset style="vertical-align: top" type="button" value="Reset" onclick="reset()"><br>
<br><br><br>
<span style="float:right"><a href="JSCleaner.jar">Validate<br>a Folder</a></span>
</td><td>Parsed Parts:<br> <textarea  rows=40 cols=70 id="s"></textarea></td></tr></table>
 
 
<script>
var pr = null;
function nextt()
{
   $('reset').style.backgroundColor = null;  
   if (pr == null) pr = new JSParser($('t').value);
   var x = pr.nextToken();
   if (x!=null)
   $('s').value += x.type + "     "  + x.token.replace(/\r\n/,'\\r\\n').replace(/\r/,'\\r').replace(/\n/,'\\n').replace(/\t/,'\\t') + "\n";
} 
var total = 0;
function tokens(t)
{
   $('reset').style.backgroundColor = null;  
   if (t.value == 'All Tokens')
   {
       for (let i of "tvfsa".split(/|/)) $(i+'c').innerHTML = '';
       total = 0;
   }
   if (pr == null) pr = new JSParser($('t').value);
   let x; var k=0;
   while ((x = pr.nextToken()) != null)
   {
       $('s').value +=(x.type + "      " + x.token.replace(/\r\n/,'\\r\\n').replace(/\r/,'\\r').replace(/\n/,'\\n').replace(/\t/,'\\t') + '\n');
       k++;
       if (k == 10000) break;
   }
   
   total += k;
   $('tc').innerHTML = total;
   if (x != null)
    t.value = 'Continue';
   else
   { 
       t.value = 'All Tokens';
       $('reset').style.backgroundColor = 'orange';  
   }
    
} 

function next(which,one)
{
   $('reset').style.backgroundColor = null;  
   for (let i of "tvfsa".split(/|/)) $(i+'c').innerHTML = '';
   if (pr == null)
   pr = new JSParser($('t').value);
   let x;
   var k = 0;
   while ( (x = pr.nextPiece())!=null)
   {
       if (which=='any' || x.type == which)
       {
           $('s').value += x.codes + "\n";
           if (one!=null)return;
           k++;
       }    
   }
   $(which.charAt(0) + 'c').innerHTML = k; 
   if (one == null || x == null)
   {
      $('reset').style.backgroundColor = 'orange';  
   }
} 

function reset()
{
   pr = new JSParser($('t').value);
   $('s').value = '';
   $('reset').style.backgroundColor = null;  
}    

onload = function()
{
    let h = thispageheight();
    let w = thispagewidth();
    
    $('t').style.width = (w/2-60) + 'px';
    $('s').style.width = (w/2-60) + 'px';
    $('t').style.height = (h-90) + 'px';
    $('s').style.height = (h-90) + 'px';
    
}
 
onresize = function()
{
   $('t').style.width =   '10px';
   $('s').style.width =  '10px';
   onload();
}
 
</script>
    </body>
</html>
